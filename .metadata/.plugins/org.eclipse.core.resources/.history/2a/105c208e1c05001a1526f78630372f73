<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  
					"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="boardMapper">
	<select id="getBoardList"  parameterType="com.fusion1.dao.PagenationVO" resultType="com.fusion1.dao.BoardVO">
		SELECT * FROM BOARDTBL ORDER BY board_parentsno DESC, board_grouporder ASC LIMIT #{pageCon}, #{pageList}
	</select>
	
	<select id="getBoardOne" resultType="com.fusion1.dao.BoardVO">
		SELECT * FROM BOARDTBL WHERE board_no = #{board_no}
	</select>
	
	<select id="getBoardCount" resultType="int">
		SELECT COUNT(*) FROM BOARDTBL
	</select>
	
	<update id="updateBoardOne" parameterType="com.fusion1.dao.BoardVO">
		UPDATE BOARDTBL SET board_title = #{board_title}, board_content = #{board_content} WHERE board_no = #{board_no}
	</update>
	
	<update id="deleteBoardOne" parameterType="com.fusion1.dao.BoardVO">
		UPDATE BOARDTBL SET board_deletecon = 1 WHERE board_no = #{board_no}
	</update>
	
	<insert id="insertBoardOne" useGeneratedKeys="true" keyProperty="board_no" parameterType="com.fusion1.dao.BoardVO">
		INSERT INTO BOARDTBL VALUES (0, #{board_writer}, #{board_userid}, #{board_title}, #{board_content}, 0, now(), 0, 0, 0, 0, 0)
	</insert>
	
	<insert id="reWriteBoard" parameterType="com.fusion1.dao.BoardVO">
		INSERT INTO BOARDTBL VALUES(0, #{board_writer}, #{board_userid}, #{board_title}, #{board_content}, 0, now(), #{board_parentsno}, #{})
	</insert>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<select id="getBoardSearchCount" parameterType="com.fusion1.dao.PagenationVO" resultType="int">
		SELECT COUNT(*) FROM BOARDTBL
		<if test="searchCon == 1">
			WHERE board_title LIKE CONCAT('%', #{keyword}, '%') ORDER BY board_date DESC
		</if>
		<if test="searchCon == 2">
			WHERE board_content LIKE CONCAT('%', #{keyword}, '%') ORDER BY board_date DESC
		</if>
		<if test="searchCon == 3">
			WHERE board_writer LIKE CONCAT('%', #{keyword}, '%') ORDER BY board_date DESC
		</if> 
	</select>
	
	<select id="getBoardSearchList" parameterType="com.fusion1.dao.PagenationVO" resultType="com.fusion1.dao.BoardVO">
		SELECT * FROM BOARDTBL
		<if test="searchCon == 1">
			WHERE board_title LIKE CONCAT('%', #{keyword}, '%') LIMIT #{pageCon}, #{pageList}
		</if>
		<if test="searchCon == 2">
			WHERE board_content LIKE CONCAT('%', #{keyword}, '%') LIMIT #{pageCon}, #{pageList}
		</if>
		<if test="searchCon == 3">
			WHERE board_writer LIKE CONCAT('%', #{keyword}, '%') LIMIT #{pageCon}, #{pageList}
		</if>
	</select>
	
	
</mapper>